# ================== æ ¸å¿ƒé…ç½® ==================
port: 7890
allow-lan: true
mode: rule
log-level: info
unified-delay: true
global-client-fingerprint: chrome
external-controller: 0.0.0.0:9090
external-ui: ui

# ================== TUN å¢å¼ºæ¨¡å¼ ==================
tun:
  enable: true
  device: meta
  stack: system
  dns-hijack:
    - 'any:53'
  auto-route: true
  auto-detect-interface: true

# ================== èŠ‚ç‚¹è®¢é˜…é…ç½® ==================
proxy-providers:
  mynodes:
    type: http
    url: "https://luhaha2025.dpdns.org/ecbd8f90-7b17-4f30-b5a9-c111af43a8d8?clash"
    path: ./profiles/proxies/mynodes.yaml
    interval: 3600
    health-check:  # å¥åº·æ£€æŸ¥é…ç½®[1](@ref)
      enable: true
      url: http://www.gstatic.com/generate_204
      interval: 300

# ================== å»å¹¿å‘Šè§„åˆ™è®¢é˜… ==================
rule-providers:
  adblock:
    type: http
    behavior: domain
    url: "https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/BanAD.list"
    path: ./profiles/rules/adblock.yaml
    interval: 86400
  
  anti-ad:
    type: http
    behavior: domain
    url: "https://anti-ad.net/clash.yaml"
    path: ./profiles/rules/anti-ad.yaml
    interval: 43200

# ================== ä»£ç†ç»„é‡æ„ ==================
proxy-groups:
  # è´Ÿè½½å‡è¡¡ç»„ï¼ˆè½®è¯¢ç­–ç•¥ï¼‰[1](@ref)
  - name: "âš–ï¸è´Ÿè½½å‡è¡¡"
    type: load-balance
    strategy: round-robin
    url: http://www.gstatic.com/generate_204
    interval: 300
    use: [mynodes]  # åŠ¨æ€å¼•ç”¨è®¢é˜…èŠ‚ç‚¹

  # è‡ªåŠ¨é€‰æ‹©ç»„ï¼ˆå»¶è¿Ÿä¼˜å…ˆï¼‰
  - name: "ğŸš€è‡ªåŠ¨é€‰æ‹©"
    type: url-test
    url: http://www.gstatic.com/generate_204
    interval: 300
    tolerance: 50
    use: [mynodes]

  # ä¸»é€‰æ‹©ç»„ï¼ˆå±‚çº§æ¸…æ™°åŒ–ï¼‰[7](@ref)
  - name: "ğŸŒé€‰æ‹©ä»£ç†"
    type: select
    proxies:
      - "âš–ï¸è´Ÿè½½å‡è¡¡"
      - "ğŸš€è‡ªåŠ¨é€‰æ‹©"
      - DIRECT
      # é™æ€èŠ‚ç‚¹å…œåº•ï¼ˆç¤ºä¾‹ï¼‰
      - CF_V8_usa.visa.com_443
      - CF_V9_myanmar.visa.com_8443

# ================== æµé‡è§„åˆ™ ==================
rules:
  - RULE-SET,adblock,REJECT  # å¹¿å‘Šæ‹¦æˆªè§„åˆ™[5](@ref)
  - RULE-SET,anti-ad,REJECT
  - GEOIP,LAN,DIRECT
  - GEOIP,CN,DIRECT
  # å…³é”®åŸŸååˆ†æµè§„åˆ™[1](@ref)
  - DOMAIN-SUFFIX,google.com,âš–ï¸è´Ÿè½½å‡è¡¡
  - DOMAIN-SUFFIX,youtube.com,âš–ï¸è´Ÿè½½å‡è¡¡
  - DOMAIN-SUFFIX,netflix.com,ğŸš€è‡ªåŠ¨é€‰æ‹©
  - DOMAIN-KEYWORD,visa,DIRECT  # é¿å…ä»£ç†è‡ªèº«åŸŸå
  - MATCH,ğŸŒé€‰æ‹©ä»£ç†

# ================== DNS ä¼˜åŒ–é…ç½® ==================
dns:
  enable: true
  listen: 0.0.0.0:53
  ipv6: true
  enhanced-mode: fake-ip
  fake-ip-range: 198.18.0.1/16
  nameserver:
    - https://dns.alidns.com/dns-query
    - https://doh.pub/dns-query
  fallback:
    - tls://8.8.8.8:853
    - tls://1.1.1.1:853
  fallback-filter:
    geoip: true
    geoip-code: CN
    ipcidr:
      - 240.0.0.0/4
